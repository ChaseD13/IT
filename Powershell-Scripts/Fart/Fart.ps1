<#

          _____                    _____                    _____                    _____                                                                             
         /\    \                  /\    \                  /\    \                  /\    \                                                                            
        /::\    \                /::\    \                /::\____\                /::\    \                                                                           
       /::::\    \               \:::\    \              /::::|   |               /::::\    \                                                                          
      /::::::\    \               \:::\    \            /:::::|   |              /::::::\    \                                                                         
     /:::/\:::\    \               \:::\    \          /::::::|   |             /:::/\:::\    \                                                                        
    /:::/__\:::\    \               \:::\    \        /:::/|::|   |            /:::/  \:::\    \                                                                       
   /::::\   \:::\    \              /::::\    \      /:::/ |::|   |           /:::/    \:::\    \                                                                      
  /::::::\   \:::\    \    ____    /::::::\    \    /:::/  |::|   | _____    /:::/    / \:::\    \                                                                     
 /:::/\:::\   \:::\    \  /\   \  /:::/\:::\    \  /:::/   |::|   |/\    \  /:::/    /   \:::\ ___\                                                                    
/:::/  \:::\   \:::\____\/::\   \/:::/  \:::\____\/:: /    |::|   /::\____\/:::/____/     \:::|    |                                                                   
\::/    \:::\   \::/    /\:::\  /:::/    \::/    /\::/    /|::|  /:::/    /\:::\    \     /:::|____|                                                                   
 \/____/ \:::\   \/____/  \:::\/:::/    / \/____/  \/____/ |::| /:::/    /  \:::\    \   /:::/    /                                                                    
          \:::\    \       \::::::/    /                   |::|/:::/    /    \:::\    \ /:::/    /                                                                     
           \:::\____\       \::::/____/                    |::::::/    /      \:::\    /:::/    /                                                                      
            \::/    /        \:::\    \                    |:::::/    /        \:::\  /:::/    /                                                                       
             \/____/          \:::\    \                   |::::/    /          \:::\/:::/    /                                                                        
                               \:::\    \                  /:::/    /            \::::::/    /                                                                         
                                \:::\____\                /:::/    /              \::::/    /                                                                          
                                 \::/    /                \::/    /                \::/____/                                                                           
                                  \/____/                  \/____/                  ~~                                                                                 
                                                                                                                                                                       
          _____                    _____                    _____                                                                                                      
         /\    \                  /\    \                  /\    \                                                                                                     
        /::\    \                /::\____\                /::\    \                                                                                                    
       /::::\    \              /::::|   |               /::::\    \                                                                                                   
      /::::::\    \            /:::::|   |              /::::::\    \                                                                                                  
     /:::/\:::\    \          /::::::|   |             /:::/\:::\    \                                                                                                 
    /:::/__\:::\    \        /:::/|::|   |            /:::/  \:::\    \                                                                                                
   /::::\   \:::\    \      /:::/ |::|   |           /:::/    \:::\    \                                                                                               
  /::::::\   \:::\    \    /:::/  |::|   | _____    /:::/    / \:::\    \                                                                                              
 /:::/\:::\   \:::\    \  /:::/   |::|   |/\    \  /:::/    /   \:::\ ___\                                                                                             
/:::/  \:::\   \:::\____\/:: /    |::|   /::\____\/:::/____/     \:::|    |                                                                                            
\::/    \:::\  /:::/    /\::/    /|::|  /:::/    /\:::\    \     /:::|____|                                                                                            
 \/____/ \:::\/:::/    /  \/____/ |::| /:::/    /  \:::\    \   /:::/    /                                                                                             
          \::::::/    /           |::|/:::/    /    \:::\    \ /:::/    /                                                                                              
           \::::/    /            |::::::/    /      \:::\    /:::/    /                                                                                               
           /:::/    /             |:::::/    /        \:::\  /:::/    /                                                                                                
          /:::/    /              |::::/    /          \:::\/:::/    /                                                                                                 
         /:::/    /               /:::/    /            \::::::/    /                                                                                                  
        /:::/    /               /:::/    /              \::::/    /                                                                                                   
        \::/    /                \::/    /                \::/____/                                                                                                    
         \/____/                  \/____/                  ~~                                                                                                          
                                                                                                                                                                       
          _____                    _____                    _____                    _____            _____                    _____                    _____          
         /\    \                  /\    \                  /\    \                  /\    \          /\    \                  /\    \                  /\    \         
        /::\    \                /::\    \                /::\    \                /::\____\        /::\    \                /::\    \                /::\    \        
       /::::\    \              /::::\    \              /::::\    \              /:::/    /       /::::\    \              /::::\    \              /::::\    \       
      /::::::\    \            /::::::\    \            /::::::\    \            /:::/    /       /::::::\    \            /::::::\    \            /::::::\    \      
     /:::/\:::\    \          /:::/\:::\    \          /:::/\:::\    \          /:::/    /       /:::/\:::\    \          /:::/\:::\    \          /:::/\:::\    \     
    /:::/__\:::\    \        /:::/__\:::\    \        /:::/__\:::\    \        /:::/    /       /:::/__\:::\    \        /:::/  \:::\    \        /:::/__\:::\    \    
   /::::\   \:::\    \      /::::\   \:::\    \      /::::\   \:::\    \      /:::/    /       /::::\   \:::\    \      /:::/    \:::\    \      /::::\   \:::\    \   
  /::::::\   \:::\    \    /::::::\   \:::\    \    /::::::\   \:::\    \    /:::/    /       /::::::\   \:::\    \    /:::/    / \:::\    \    /::::::\   \:::\    \  
 /:::/\:::\   \:::\____\  /:::/\:::\   \:::\    \  /:::/\:::\   \:::\____\  /:::/    /       /:::/\:::\   \:::\    \  /:::/    /   \:::\    \  /:::/\:::\   \:::\    \ 
/:::/  \:::\   \:::|    |/:::/__\:::\   \:::\____\/:::/  \:::\   \:::|    |/:::/____/       /:::/  \:::\   \:::\____\/:::/____/     \:::\____\/:::/__\:::\   \:::\____\
\::/   |::::\  /:::|____|\:::\   \:::\   \::/    /\::/    \:::\  /:::|____|\:::\    \       \::/    \:::\  /:::/    /\:::\    \      \::/    /\:::\   \:::\   \::/    /
 \/____|:::::\/:::/    /  \:::\   \:::\   \/____/  \/_____/\:::\/:::/    /  \:::\    \       \/____/ \:::\/:::/    /  \:::\    \      \/____/  \:::\   \:::\   \/____/ 
       |:::::::::/    /    \:::\   \:::\    \               \::::::/    /    \:::\    \               \::::::/    /    \:::\    \               \:::\   \:::\    \     
       |::|\::::/    /      \:::\   \:::\____\               \::::/    /      \:::\    \               \::::/    /      \:::\    \               \:::\   \:::\____\    
       |::| \::/____/        \:::\   \::/    /                \::/____/        \:::\    \              /:::/    /        \:::\    \               \:::\   \::/    /    
       |::|  ~|               \:::\   \/____/                  ~~               \:::\    \            /:::/    /          \:::\    \               \:::\   \/____/     
       |::|   |                \:::\    \                                        \:::\    \          /:::/    /            \:::\    \               \:::\    \         
       \::|   |                 \:::\____\                                        \:::\____\        /:::/    /              \:::\____\               \:::\____\        
        \:|   |                  \::/    /                                         \::/    /        \::/    /                \::/    /                \::/    /        
         \|___|                   \/____/                                           \/____/          \/____/                  \/____/                  \/____/         
                                                                                                                                                                       
      _____                    _____                                        _____                                                                                      
     /\    \                  /\    \                 ______               /\    \                                                                                     
    /::\    \                /::\    \               |::|   |             /::\    \                                                                                    
    \:::\    \              /::::\    \              |::|   |             \:::\    \                                                                                   
     \:::\    \            /::::::\    \             |::|   |              \:::\    \                                                                                  
      \:::\    \          /:::/\:::\    \            |::|   |               \:::\    \                                                                                 
       \:::\    \        /:::/__\:::\    \           |::|   |                \:::\    \                                                                                
       /::::\    \      /::::\   \:::\    \          |::|   |                /::::\    \                                                                               
      /::::::\    \    /::::::\   \:::\    \         |::|   |               /::::::\    \                                                                              
     /:::/\:::\    \  /:::/\:::\   \:::\    \  ______|::|___|___ ____      /:::/\:::\    \                                                                             
    /:::/  \:::\____\/:::/__\:::\   \:::\____\|:::::::::::::::::|    |    /:::/  \:::\____\                                                                            
   /:::/    \::/    /\:::\   \:::\   \::/    /|:::::::::::::::::|____|   /:::/    \::/    /                                                                            
  /:::/    / \/____/  \:::\   \:::\   \/____/  ~~~~~~|::|~~~|~~~        /:::/    / \/____/                                                                             
 /:::/    /            \:::\   \:::\    \            |::|   |          /:::/    /                                                                                      
/:::/    /              \:::\   \:::\____\           |::|   |         /:::/    /                                                                                       
\::/    /                \:::\   \::/    /           |::|   |         \::/    /                                                                                        
 \/____/                  \:::\   \/____/            |::|   |          \/____/                                                                                         
                           \:::\    \                |::|   |                                                                                                          
                            \:::\____\               |::|   |                                                                                                          
                             \::/    /               |::|___|                                                                                                          
                              \/____/                 ~~                                                                                                               
                                                                                                                                                                       
>#

<#
.SYNOPSIS
  This script looks through a folder's files and sub folders to find a user inputed string and replace it with another user inputed string 

.DESCRIPTION
  Firstly the user is prompted for the folder path and the string they are looking for. Next, they are asked wether to display all files containing the string.
  Then the user replies wether they want to create a copy of the folder or not. Then at the end it prompts the user to decide if they want to make changes or not.

.PARAMETER <Parameter_Name>
    No parameters

.INPUTS
  None

.OUTPUTS
  None

.NOTES
  Version:        1.0
  Author:         Chase Dudas
  Creation Date:  8/3/2018
  Purpose/Change: Initial script development
  
.EXAMPLE
  ./Fart.ps1
  1. C:\print2mail\Animal_Services
  2. 157.145.204.180
  3. y
  *hit enter*
  4. y
  5. C:\User\Chase\Desktop
  *hit enter*
  6. y
  7. 10.10.10.10
   
#>

#-----------------------------------------------------------[Functions]------------------------------------------------------------

function readFart()
{
   Write-Host(Get-ChildItem $fartFile -recurse -Filter *.bat | Select-String -pattern $fartString | group path | select name) 
   
   Write-Host "Done"
}

function copyFart($fromFolder)
{
    #Dialog box to prompt the user for what zip file they would like to check
    [System.Reflection.Assembly]::LoadWithPartialName('Microsoft.VisualBasic') | Out-Null
    $toFolder = [Microsoft.VisualBasic.Interaction]::InputBox("Where would you like to save the copy?: ", "Copy Destination", " ")
    try
    {
        if(test-path $toFolder) 
        {
            Remove-Item $toFolder
        }
    
        Copy-Item $fromFolder -Filter *.bat -Destination $toFolder –Recurse -Force
    }
    catch
    {
        Write-Warning "File path test failed : copyFart `n"
    }
}

function changeFart($oldString)
{    
    [System.Reflection.Assembly]::LoadWithPartialName('Microsoft.VisualBasic') | Out-Null
    $newString = [Microsoft.VisualBasic.Interaction]::InputBox("What would you like to change it to?: ", "New String", " ")

    [IO.File]::ReadAllText($fartFile).Replace($fartString,$newString) | Set-Content $filename -Force
}

#---------------------------------------------------------[Initialisations]--------------------------------------------------------

#----------------------------------------------------------[Declarations]----------------------------------------------------------

#Dialog box to prompt the user for what zip file they would like to check
[System.Reflection.Assembly]::LoadWithPartialName('Microsoft.VisualBasic') | Out-Null
$fartFile = [Microsoft.VisualBasic.Interaction]::InputBox("Put the file path of the folder: ", "Fart", "")

[System.Reflection.Assembly]::LoadWithPartialName('Microsoft.VisualBasic') | Out-Null
$fartString = [Microsoft.VisualBasic.Interaction]::InputBox("What phrase are you looking to change?: ", "Fart String", "")

#-----------------------------------------------------------[Execution]------------------------------------------------------------

[System.Reflection.Assembly]::LoadWithPartialName('Microsoft.VisualBasic') | Out-Null
$fartRead = [Microsoft.VisualBasic.Interaction]::InputBox("Do you want to scan the folder first?: ", "Scan?", "y/n")

    Switch($fartRead)
    {
        y{ readFart $fartExt }

        n{ continue }

        default{ continue }   
    }

pause

[System.Reflection.Assembly]::LoadWithPartialName('Microsoft.VisualBasic') | Out-Null
$fartCopy = [Microsoft.VisualBasic.Interaction]::InputBox("Do you want to create a copy: ", "Archive?", "y/n")

    Switch($fartCopy)
    {
        y{ copyFart $fartFile }

        n{ continue }

        default{ continue }   
    }

pause

[System.Reflection.Assembly]::LoadWithPartialName('Microsoft.VisualBasic') | Out-Null
$fartChange = [Microsoft.VisualBasic.Interaction]::InputBox("Do you want to make changes?: ", "Changes?", "y/n")

     Switch($fartChange)
    {
        y{ changeFart }

        n{ continue }

        default{ continue }   
    }
